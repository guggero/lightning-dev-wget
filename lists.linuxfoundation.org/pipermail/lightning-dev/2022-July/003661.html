<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Onion messages rate-limiting
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2022-July/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Onion%20messages%20rate-limiting&In-Reply-To=%3CCAJBJmV_mrccLvtw%3D0suzEDQxH%2BknPmDh1UFDweiO-6Hu3i5Csg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003660.html">
   <LINK REL="Next"  HREF="003662.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Onion messages rate-limiting</H1>
    <B>Joost Jager</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Onion%20messages%20rate-limiting&In-Reply-To=%3CCAJBJmV_mrccLvtw%3D0suzEDQxH%2BknPmDh1UFDweiO-6Hu3i5Csg%40mail.gmail.com%3E"
       TITLE="[Lightning-dev] Onion messages rate-limiting">joost.jager at gmail.com
       </A><BR>
    <I>Sun Jul 10 08:43:27 UTC 2022</I>
    <P><UL>
        <LI>Previous message: <A HREF="003660.html">[Lightning-dev] Onion messages rate-limiting
</A></li>
        <LI>Next message: <A HREF="003662.html">[Lightning-dev] Onion messages rate-limiting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3661">[ date ]</a>
              <a href="thread.html#3661">[ thread ]</a>
              <a href="subject.html#3661">[ subject ]</a>
              <a href="author.html#3661">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Jun 30, 2022 at 4:19 AM Matt Corallo &lt;<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">lf-lists at mattcorallo.com</A>&gt;
wrote:

&gt;<i> Better yet, as Val points out, requiring a channel to relay onion messages
</I>&gt;<i> puts a very real,
</I>&gt;<i> nontrivial (in a world of msats) cost to getting an onion messaging
</I>&gt;<i> channel. Better yet, with
</I>&gt;<i> backpressure ability to DoS onion message links isn't denominated in
</I>&gt;<i> number of messages, but instead
</I>&gt;<i> in number of channels you are able to create, making the backpressure
</I>&gt;<i> system equivalent to today's
</I>&gt;<i> HTLC DoS considerations, whereas explicit payment allows an attacker to
</I>&gt;<i> pay much less to break the
</I>&gt;<i> system.
</I>&gt;<i>
</I>
It can also be considered a bad thing that DoS ability is not based on a
number of messages. It means that for the one time cost of channel
open/close, the attacker can generate spam forever if they stay right below
the rate limit.


&gt;<i> Ultimately, paying suffers from the standard PoW-for-spam issue - you
</I>&gt;<i> cannot assign a reasonable
</I>&gt;<i> cost that an attacker cares about without impacting the system's usability
</I>&gt;<i> due to said cost. Indeed,
</I>&gt;<i> making it expensive enough to mount a months-long DDoS without impacting
</I>&gt;<i> legitimate users be pretty
</I>&gt;<i> easy - at 1msat per relay of a 1366 byte onion message you can only
</I>&gt;<i> saturate an average home users'
</I>&gt;<i> 30Mbps connection for 30 minutes before you rack up a dollar in costs, but
</I>&gt;<i> if your concern is
</I>&gt;<i> whether someone can reasonably trivially take out the network for minutes
</I>&gt;<i> at a time to make it have
</I>&gt;<i> perceptibly high failure rates, no reasonable cost scheme will work. Quite
</I>&gt;<i> the opposite - the only
</I>&gt;<i> reasonable way to respond is to respond to a spike in traffic while
</I>&gt;<i> maintaining QoS is to rate-limit
</I>&gt;<i> by inbound edge!
</I>&gt;<i>
</I>
Suppose the attacker has enough channels to hit the rate limit on an
important connection some hops away from themselves. They can then sustain
that attack indefinitely, assuming that they stay below the rate limit on
the routes towards the target connection. What will the response be in that
case? Will node operators work together to try to trace back to the source
and take down the attacker? That requires operators to know each other.

Maybe this is a difference between lightning network and the internet that
is relevant for this discussion. That routers on the internet know each
other and have physical links between them, where as in lightning ties can
be much looser.

Joost
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20220710/d7fe084e/attachment.html">http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20220710/d7fe084e/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003660.html">[Lightning-dev] Onion messages rate-limiting
</A></li>
	<LI>Next message: <A HREF="003662.html">[Lightning-dev] Onion messages rate-limiting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3661">[ date ]</a>
              <a href="thread.html#3661">[ thread ]</a>
              <a href="subject.html#3661">[ subject ]</a>
              <a href="author.html#3661">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
