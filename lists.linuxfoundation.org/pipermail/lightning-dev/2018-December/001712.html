<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Reason for having HMACs in Sphinx
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-December/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Reason%20for%20having%20HMACs%20in%20Sphinx&In-Reply-To=%3CtKOQS9kVgLdkXw1UQ5aXvyaB6GnoYgL7DFByxcLKW2yquax6eMZlSOY1Sb6lL1teH6Oi8nfL7UYd_OA0TL9jHH-0VmRb7rbYlO3ywZTxvys%3D%40protonmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001711.html">
   <LINK REL="Next"  HREF="001713.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Reason for having HMACs in Sphinx</H1>
    <B>ZmnSCPxj</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Reason%20for%20having%20HMACs%20in%20Sphinx&In-Reply-To=%3CtKOQS9kVgLdkXw1UQ5aXvyaB6GnoYgL7DFByxcLKW2yquax6eMZlSOY1Sb6lL1teH6Oi8nfL7UYd_OA0TL9jHH-0VmRb7rbYlO3ywZTxvys%3D%40protonmail.com%3E"
       TITLE="[Lightning-dev] Reason for having HMACs in Sphinx">ZmnSCPxj at protonmail.com
       </A><BR>
    <I>Tue Dec  4 10:38:58 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="001711.html">[Lightning-dev] Reason for having HMACs in Sphinx
</A></li>
        <LI>Next message: <A HREF="001713.html">[Lightning-dev] Reason for having HMACs in Sphinx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1712">[ date ]</a>
              <a href="thread.html#1712">[ thread ]</a>
              <a href="subject.html#1712">[ subject ]</a>
              <a href="author.html#1712">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good morning CJP,


&gt;<i> I think we could stop this type of attack by including some kind of
</I>&gt;<i> shared secret in the onion message to the final node:
</I>
I think we get this &quot;for free&quot; if we switch to path decorrelation and points+privkeys instead of hashes+preimages.

Path decorrelation means that each hop is given a random point, to be added to the next SS &quot;HTLC&quot;.
The final node needs to be given the total of the scalars of each hop random point along the route, most likely within the last hop of the onion.
The final node also cannot differentiate between an incorrect total for this scalar, or an incorrect &quot;invoice hash&quot;/invoice point.

Hence, some intermediate node along the way cannot guess this, and the final node will give the same error, i.e. &quot;invoice point not found&quot;.

Regards,
ZmnSCPxj
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001711.html">[Lightning-dev] Reason for having HMACs in Sphinx
</A></li>
	<LI>Next message: <A HREF="001713.html">[Lightning-dev] Reason for having HMACs in Sphinx
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1712">[ date ]</a>
              <a href="thread.html#1712">[ thread ]</a>
              <a href="subject.html#1712">[ subject ]</a>
              <a href="author.html#1712">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
