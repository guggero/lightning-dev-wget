<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] CPFP Carve-Out for Fee-Prediction Issues in Contracting Applications (eg Lightning)
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-October/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20CPFP%20Carve-Out%20for%20Fee-Prediction%20Issues%20in%0A%20Contracting%20Applications%20%28eg%20Lightning%29&In-Reply-To=%3C20191027225402.rfajp4j6itujq5av%40ganymede%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002261.html">
   <LINK REL="Next"  HREF="002241.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] CPFP Carve-Out for Fee-Prediction Issues in Contracting Applications (eg Lightning)</H1>
    <B>David A. Harding</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20CPFP%20Carve-Out%20for%20Fee-Prediction%20Issues%20in%0A%20Contracting%20Applications%20%28eg%20Lightning%29&In-Reply-To=%3C20191027225402.rfajp4j6itujq5av%40ganymede%3E"
       TITLE="[Lightning-dev] CPFP Carve-Out for Fee-Prediction Issues in Contracting Applications (eg Lightning)">dave at dtrt.org
       </A><BR>
    <I>Sun Oct 27 22:54:02 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="002261.html">[Lightning-dev] CPFP Carve-Out for Fee-Prediction Issues in Contracting Applications (eg Lightning)
</A></li>
        <LI>Next message: <A HREF="002241.html">[Lightning-dev] Unpublished Channels,	and a Proposal for Local Channel Publication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2252">[ date ]</a>
              <a href="thread.html#2252">[ thread ]</a>
              <a href="subject.html#2252">[ subject ]</a>
              <a href="author.html#2252">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Oct 24, 2019 at 03:49:09PM +0200, Johan Tor&#229;s Halseth wrote:
&gt;<i> [...] what about letting the rule be
</I>&gt;<i> 
</I>&gt;<i> The last transaction which is added to a package of dependent
</I>&gt;<i> transactions in the mempool must:
</I>&gt;<i>   * Have no more than one unconfirmed parent.
</I>&gt;<i> [... subsequent email ...]
</I>&gt;<i> I realize these limits are there for a reason though, but I'm wondering if
</I>&gt;<i> we could relax them.
</I>
Johan,

I'm not sure any of the other replies to this thread addressed your
request for a reason behind the limits related to your proposal, so I
thought I'd point out that---subsequent to your posting here---a
document[1] was added to the Bitcoin Core developer wiki that I think
describes the risk of the approach you proposed:

&gt;<i> Free relay attack:
</I>&gt;<i>
</I>&gt;<i> - Create a low feerate transaction T.
</I>&gt;<i>
</I>&gt;<i> - Send zillions of child transactions that are slightly higher feerate
</I>&gt;<i>   than T until mempool is full.
</I>&gt;<i>
</I>&gt;<i> - Create one small transaction with feerate just higher than T&#8217;s, and
</I>&gt;<i>    watch T and all its children get evicted. Total fees in mempool drops
</I>&gt;<i>    dramatically!
</I>&gt;<i>
</I>&gt;<i> - Attacker just relayed (say) 300MB of data across the whole network
</I>&gt;<i>   but only pays small feerate on one small transaction.
</I>
The document goes on to describe at a high level how Bitcoin Core
attempts to mitigate this problem as well as other ways it tries to
optimize the mempool in order to maximize miner profit (and so ensure
that miners continue to use public transaction relay).

I hope that's helpful to you and to others in both understanding the
current state and in thinking about ways in which it might be improved.

-Dave

[1] <A HREF="https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Mempool-and-mining">https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Mempool-and-mining</A>
    Content adapted from slides by Suhas Daftuar, uploaded and formatted
    by Gregory Sanders and Marco Falke.

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002261.html">[Lightning-dev] CPFP Carve-Out for Fee-Prediction Issues in Contracting Applications (eg Lightning)
</A></li>
	<LI>Next message: <A HREF="002241.html">[Lightning-dev] Unpublished Channels,	and a Proposal for Local Channel Publication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2252">[ date ]</a>
              <a href="thread.html#2252">[ thread ]</a>
              <a href="subject.html#2252">[ subject ]</a>
              <a href="author.html#2252">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
