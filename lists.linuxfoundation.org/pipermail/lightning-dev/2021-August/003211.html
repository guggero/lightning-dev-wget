<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Do we really want users to solve an NP-hard	problem when they wish to find a cheap way of paying each	other on the Lightning Network?
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2021-August/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Do%20we%20really%20want%20users%20to%20solve%20an%20NP-hard%0A%09problem%20when%20they%20wish%20to%20find%20a%20cheap%20way%20of%20paying%20each%0A%09other%20on%20the%20Lightning%20Network%3F&In-Reply-To=%3C0ildswzd_Ly7lyTpmC59PeZA4IeoiEDfyEKqi63jPpcAaeTR2njiMV57TwRoW6LsooX37MXEXcx1n_Q3MK6Ku_q7IvUufZIhrIeWgoHywKs%3D%40protonmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003210.html">
   <LINK REL="Next"  HREF="003214.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Do we really want users to solve an NP-hard	problem when they wish to find a cheap way of paying each	other on the Lightning Network?</H1>
    <B>ZmnSCPxj</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Do%20we%20really%20want%20users%20to%20solve%20an%20NP-hard%0A%09problem%20when%20they%20wish%20to%20find%20a%20cheap%20way%20of%20paying%20each%0A%09other%20on%20the%20Lightning%20Network%3F&In-Reply-To=%3C0ildswzd_Ly7lyTpmC59PeZA4IeoiEDfyEKqi63jPpcAaeTR2njiMV57TwRoW6LsooX37MXEXcx1n_Q3MK6Ku_q7IvUufZIhrIeWgoHywKs%3D%40protonmail.com%3E"
       TITLE="[Lightning-dev] Do we really want users to solve an NP-hard	problem when they wish to find a cheap way of paying each	other on the Lightning Network?">ZmnSCPxj at protonmail.com
       </A><BR>
    <I>Tue Aug 31 08:29:51 UTC 2021</I>
    <P><UL>
        <LI>Previous message: <A HREF="003210.html">[Lightning-dev] Do we really want users to solve an NP-hard problem when they wish to find a cheap way of paying each other on the Lightning Network?
</A></li>
        <LI>Next message: <A HREF="003214.html">[Lightning-dev] Do we really want users to solve an NP-hard problem when they wish to find a cheap way of paying each other on the Lightning Network?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3211">[ date ]</a>
              <a href="thread.html#3211">[ thread ]</a>
              <a href="subject.html#3211">[ subject ]</a>
              <a href="author.html#3211">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good morning aj and Rene,

&gt;<i> On Thu, Aug 26, 2021 at 04:33:23PM +0200, Ren&#233; Pickhardt via Lightning-dev wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; As we thought it was obvious that the function is not linear we only explained
</I>&gt;<i> &gt; in the paper how the jump from f(0)=0 to f(1) = ppm+base_fee breaks convexity.
</I>&gt;<i>
</I>&gt;<i> (This would make more sense to me as &quot;f(0)=0 but f(epsilon)-&gt;b as
</I>&gt;<i> epsilon-&gt;0, so it's discontinuous&quot;)
</I>
I as well, &quot;discontinuous&quot; is how I would understand it, and it really needs to be pointed out to me that f(0)=0 and the sudden step to f(1)=1*prop + base is problematic.

&gt;<i>
</I>&gt;<i> &gt; &quot;Do we really want users to solve an NP-hard problem when
</I>&gt;<i> &gt; they wish to find a cheap way of paying each other on the Lightning Network?&quot;
</I>&gt;<i>
</I>&gt;<i> FWIW, my answer to this is &quot;sure, if that's the way it turns out&quot;.
</I>&gt;<i>
</I>&gt;<i> Another program which solves an NP-hard problem every time it runs is
</I>&gt;<i> &quot;apt-get install&quot; -- you can simulate 3SAT using Depends: and Conflicts:
</I>&gt;<i> relationships between packages.
</I>
Thank you for this, I now understand why functional package managers like Nix and Guix etc. exist.

&gt;<i> I worked on a related project in Debian
</I>&gt;<i> back in the day that did a slightly more complicated variant of that
</I>&gt;<i> problem, namely working out if updating a package in the distro would
</I>&gt;<i> render other packages uninstallable (eg due to providing a different
</I>&gt;<i> library version) -- as it turned out, that even actually managed to hit
</I>&gt;<i> some of the &quot;hard&quot; NP cases every now and then. But it was never really
</I>&gt;<i> that big a deal in practice: you just set an iteration limit and consider
</I>&gt;<i> it to &quot;fail&quot; if things get too complicated, and if it fails too often,
</I>&gt;<i> you re-analyse what's going on manually and add a new heuristic to cope
</I>&gt;<i> with it.
</I>&gt;<i>
</I>&gt;<i> I don't see any reason to think you can't do roughly the same for
</I>&gt;<i> lightning; at worst just consider yourself as routing on log(N) different
</I>&gt;<i> networks: one that routes payments of up to 500msat at (b+0.5ppm), one
</I>&gt;<i> that routes payments of up to 1sat at (b+ppm), one that routes payments
</I>&gt;<i> of up to 2sat at (b+2ppm), one that routes payments of up to 4sat at
</I>&gt;<i> (b+4ppm), etc. Try to choose a route for all the funds; if that fails,
</I>&gt;<i> split it; repeat. In some case that will fail despite there being a
</I>&gt;<i> possible successful multipath route, and in other cases it will choose a
</I>&gt;<i> moderately higher fee path than necessary, but if you're talking a paying
</I>&gt;<i> a 0.2% fee vs a 0.1% fee when the current state of the art is a 1% fee,
</I>&gt;<i> that's fine.
</I>
Well, something similar is already done by C-Lightning, and the `pay` algorithm even includes a time limit after which it just fails instead of retrying (roughly equivalent to setting an iteration limit, and actually more practical since it is not the number of CPU iterations that matters, it is real time during which user economic preferences may change).

And for large enough payments, it *still* does not succeed often enough in practice.

I pointed out elsewhere that failure-to-pay has an economic cost.
This economic cost is the difference between the value of the product being bought, minus the value of the bitcoin being used to pay for it.
(remember, economic value is subjective to every economic actor; the economy is simply how the differences in value plays out as actors exchange objects, where each actor has its own subjective valuation of that value.)
We can ask the user explicitly for a numeric amount equivalent to this cost, by the simple question &quot;how much are you willing to pay in order for this transaction to succeed?&quot; i.e. &quot;what is the maximum transaction fee you will accept?&quot;

Thus, failing to deliver imposes an economic cost on users, a cost that Lightning Network, rightfully or not, has implicitly promised to reduce in comparison to onchain transactions.

For myself, I think a variant of Pickhardt-Richter payments can be created which *adapts to* the reality of the current network where `base_fee &gt; 0` is common, but is biased against `base_fee &gt; 0`, can be a bridge from the current network with `base_fee &gt; 0` and a future with `#zerobasefee`.
With C-Lightning and its plugin nature allowing alternate implementations of `pay`, this can be done without requiring an entire new LN implementation.
If popular enough, because it demonstrates actual ability to transfer large funds at low fees, this can force forwarding nodes to learn that `#zerobasefee` earns them more funds (such as if they use a hill-climbing algorithm like I described to discover optimal feerates that gives them maximum earnings).
Then `#zerobasefee` just wins economically.

So I think this really just needs a good implementation somewhere.

Regards,
ZmnSCPxj
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003210.html">[Lightning-dev] Do we really want users to solve an NP-hard problem when they wish to find a cheap way of paying each other on the Lightning Network?
</A></li>
	<LI>Next message: <A HREF="003214.html">[Lightning-dev] Do we really want users to solve an NP-hard problem when they wish to find a cheap way of paying each other on the Lightning Network?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3211">[ date ]</a>
              <a href="thread.html#3211">[ thread ]</a>
              <a href="subject.html#3211">[ subject ]</a>
              <a href="author.html#3211">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
