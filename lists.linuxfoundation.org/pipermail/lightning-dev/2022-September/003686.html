<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] `htlc_maximum_msat` as a valve for flow control on	the Lightning Network
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2022-September/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20%60htlc_maximum_msat%60%20as%20a%20valve%20for%20flow%20control%20on%0A%09the%20Lightning%20Network&In-Reply-To=%3CCAJ5H3Z5eNwTrFhj%2BG3ih8AxqW%3DK-N4fzYoNW8VVV_%3Do%3DALmqPw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003696.html">
   <LINK REL="Next"  HREF="003690.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] `htlc_maximum_msat` as a valve for flow control on	the Lightning Network</H1>
    <B>Ren&#233; Pickhardt</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20%60htlc_maximum_msat%60%20as%20a%20valve%20for%20flow%20control%20on%0A%09the%20Lightning%20Network&In-Reply-To=%3CCAJ5H3Z5eNwTrFhj%2BG3ih8AxqW%3DK-N4fzYoNW8VVV_%3Do%3DALmqPw%40mail.gmail.com%3E"
       TITLE="[Lightning-dev] `htlc_maximum_msat` as a valve for flow control on	the Lightning Network">r.pickhardt at googlemail.com
       </A><BR>
    <I>Thu Sep 22 06:40:30 UTC 2022</I>
    <P><UL>
        <LI>Previous message: <A HREF="003696.html">[Lightning-dev] Fee Ratecards (your gateway to negativity)
</A></li>
        <LI>Next message: <A HREF="003690.html">[Lightning-dev] `htlc_maximum_msat` as a valve for flow control on the Lightning Network
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3686">[ date ]</a>
              <a href="thread.html#3686">[ thread ]</a>
              <a href="subject.html#3686">[ subject ]</a>
              <a href="author.html#3686">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good morning fellow Lightning Developers,

I am pleased to share my most recent research results [1] with you. They
may (if at all) only have a small impact on protocol development /
specification but are actually mainly of concern to node operators and
LSPs. I still thought they may be relevant for the list.

While trying to estimate the expected liquidity distribution in depleted
channels due to drain via Markov Models I realized that we can exploit the
`htlc_maxium_msat` setting to act as a control valve and regulate the
&quot;pressure&quot; coming from the drain and mitigate the depletion of channels.
Such ideas are btw not novel at all and heavily used in fluid networks [2].
Thus it seems very natural that we do the same on the Lightning Network.

In the article we show within a theoretic model how expected payment
failure rates per channel may drop significantly by up to an order of
magnitude if channels set up proper asymmetric `htlc_maximum_msat` pairs.

We furthermore provide in our iPython notebook [3] two experimental
algorithmic ideas with which node operators can find decent
`htlc_maximum_msat` values in a greedy fashion. One of the algorithms does
not even require to know the drain or payment size distribution or build
the Markov model but just looks at the liquidity distribution in the
channel at the last x routing attempts and adjusts the `htlc_maximum_msat`
value if the distribution is to far away from a uniform distribution.

Looking forwards for your thoughts and feedback.

with kind regards Rene


[1]:
<A HREF="https://blog.bitmex.com/the-power-of-htlc_maximum_msat-as-a-control-valve-for-better-flow-control-improved-reliability-and-lower-expected-payment-failure-rates-on-the-lightning-network/">https://blog.bitmex.com/the-power-of-htlc_maximum_msat-as-a-control-valve-for-better-flow-control-improved-reliability-and-lower-expected-payment-failure-rates-on-the-lightning-network/</A>
[2]: <A HREF="https://en.wikipedia.org/wiki/Control_valve">https://en.wikipedia.org/wiki/Control_valve</A>
[3]:
<A HREF="https://github.com/lnresearch/Flow-Control-on-Lightning-Network-Channels-with-Drain-via-Control-Valves/blob/main/htlc_maximum_msat%20as%20a%20valve%20for%20flow%20control%20on%20the%20Lightnig%20network.ipynb">https://github.com/lnresearch/Flow-Control-on-Lightning-Network-Channels-with-Drain-via-Control-Valves/blob/main/htlc_maximum_msat%20as%20a%20valve%20for%20flow%20control%20on%20the%20Lightnig%20network.ipynb</A>

-- 
<A HREF="https://ln.rene-pickhardt.de">https://ln.rene-pickhardt.de</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20220922/a895d1a1/attachment.html">http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20220922/a895d1a1/attachment.html</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003696.html">[Lightning-dev] Fee Ratecards (your gateway to negativity)
</A></li>
	<LI>Next message: <A HREF="003690.html">[Lightning-dev] `htlc_maximum_msat` as a valve for flow control on the Lightning Network
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3686">[ date ]</a>
              <a href="thread.html#3686">[ thread ]</a>
              <a href="subject.html#3686">[ subject ]</a>
              <a href="author.html#3686">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
