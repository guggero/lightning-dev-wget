<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Forwardable Peerswaps: Improving Network Health	Via Pressure Release Valve
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2022-October/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Forwardable%20Peerswaps%3A%20Improving%20Network%20Health%0A%09Via%20Pressure%20Release%20Valve&In-Reply-To=%3CWN2u-SXscGaiH4B6BL37ppFfhMPJjcCBTSv6OIZg8CIVfcY-WpL1waW1VlG-BU1Evvigg4oYo1C5479gHx7LCytgG0rp8-wlMH1u8ycHxIw%3D%40protonmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003714.html">
   <LINK REL="Next"  HREF="003722.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Forwardable Peerswaps: Improving Network Health	Via Pressure Release Valve</H1>
    <B>ZmnSCPxj</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Forwardable%20Peerswaps%3A%20Improving%20Network%20Health%0A%09Via%20Pressure%20Release%20Valve&In-Reply-To=%3CWN2u-SXscGaiH4B6BL37ppFfhMPJjcCBTSv6OIZg8CIVfcY-WpL1waW1VlG-BU1Evvigg4oYo1C5479gHx7LCytgG0rp8-wlMH1u8ycHxIw%3D%40protonmail.com%3E"
       TITLE="[Lightning-dev] Forwardable Peerswaps: Improving Network Health	Via Pressure Release Valve">ZmnSCPxj at protonmail.com
       </A><BR>
    <I>Tue Oct 11 11:14:06 UTC 2022</I>
    <P><UL>
        <LI>Previous message: <A HREF="003714.html">[Lightning-dev] Forwardable Peerswaps: Improving Network Health	Via Pressure Release Valve
</A></li>
        <LI>Next message: <A HREF="003722.html">[Lightning-dev] Forwardable Peerswaps: Improving Network Health	Via Pressure Release Valve
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3721">[ date ]</a>
              <a href="thread.html#3721">[ thread ]</a>
              <a href="subject.html#3721">[ subject ]</a>
              <a href="author.html#3721">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good morning Joe,

&gt;<i> &gt; Unfortunately, only the first sub-protocol (onchain-to-offchain)
</I>&gt;<i> &gt; is actually forwardable.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I think it's possible to forward offchain-to-onchain swap as well, by
</I>&gt;<i> just making a payjoin tx by net receiver (initiator) and net sender.
</I>&gt;<i> 
</I>&gt;<i> Let me explain it in a bit more detail.
</I>&gt;<i> 
</I>&gt;<i> IIUC, In currently deployed swap servers like lightning loop and
</I>&gt;<i> boltz, there is a feature called prepayment. In case of
</I>&gt;<i> offchain-to-onchain swap (i.e. loopout), initiator pays a small
</I>&gt;<i> off-chain fee to the swap server for them to make onchain tx, it works
</I>&gt;<i> as a DoS prevention.
</I>&gt;<i> 
</I>&gt;<i> The reason this works is because those swap servers are not
</I>&gt;<i> pseudonymous. So users are fine to put small trust against them.
</I>&gt;<i> 
</I>&gt;<i> This is not the case In your protocol (or peerswap in general). So
</I>&gt;<i> there is a risk that after the user has paid prepayment, the responder
</I>&gt;<i> simply ignores and does nothing.
</I>&gt;<i> 
</I>&gt;<i> I suppose this can be avoided by paying this DoS prevention fee with
</I>&gt;<i> onchain tx. initiator and responder makes a Payjoin tx which pays a
</I>&gt;<i> small amount to the responder.
</I>&gt;<i> 
</I>&gt;<i> In this way, the prepayment and the responder&#8217;s duty (i.e. to create a
</I>&gt;<i> first HTLC/PTLC tx for the swap) are atomic.
</I>&gt;<i> 
</I>&gt;<i> And with the additional anonymity bonus that payjoin brings.
</I>
The offchain-to-onchain swap protocol is intended to be used by end-users to pay onchain when all their funds are in a Lightning channel.
Thus, there is the possibility that the end-user has no onchain funds to payjoin into the onchain HTLC, only Lightning funds, and the only way to get it out is to swap it out to onchain, hence, catch-22.

Regards,
ZmnSCPxj
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003714.html">[Lightning-dev] Forwardable Peerswaps: Improving Network Health	Via Pressure Release Valve
</A></li>
	<LI>Next message: <A HREF="003722.html">[Lightning-dev] Forwardable Peerswaps: Improving Network Health	Via Pressure Release Valve
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3721">[ date ]</a>
              <a href="thread.html#3721">[ thread ]</a>
              <a href="subject.html#3721">[ subject ]</a>
              <a href="author.html#3721">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
