<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Preliminary Hidden Lightning Network Analysis
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2022-June/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Preliminary%20Hidden%20Lightning%20Network%20Analysis&In-Reply-To=%3CCAJ5H3Z6UBo0mJxXcs5oju699qhvCCHPz5q4DBYsCU7P__fqsZQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003602.html">
   <LINK REL="Next"  HREF="003604.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Preliminary Hidden Lightning Network Analysis</H1>
    <B>Ren&#233; Pickhardt</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Preliminary%20Hidden%20Lightning%20Network%20Analysis&In-Reply-To=%3CCAJ5H3Z6UBo0mJxXcs5oju699qhvCCHPz5q4DBYsCU7P__fqsZQ%40mail.gmail.com%3E"
       TITLE="[Lightning-dev] Preliminary Hidden Lightning Network Analysis">r.pickhardt at googlemail.com
       </A><BR>
    <I>Wed Jun  8 05:42:57 UTC 2022</I>
    <P><UL>
        <LI>Previous message: <A HREF="003602.html">[Lightning-dev] Preliminary Hidden Lightning Network Analysis
</A></li>
        <LI>Next message: <A HREF="003604.html">[Lightning-dev] Preliminary Hidden Lightning Network Analysis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3603">[ date ]</a>
              <a href="thread.html#3603">[ thread ]</a>
              <a href="subject.html#3603">[ subject ]</a>
              <a href="author.html#3603">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Tony,

Thank you for putting emphasis on this. I was actually waiting for someone
to publicly exploit this.


&gt;<i> The reason this is possible is because [...] currently channel IDs are
</I>&gt;<i> based on UTXO's. Scid aliases may be the biggest benefit here, but the use
</I>&gt;<i> of `unknown_next_peer` , `invalid_onion_hmac`,  `incorrect_cltv_expiry`,
</I>&gt;<i> and `amount_below_minimum` have been the biggest helpers in exploiting
</I>&gt;<i> channel privacy.
</I>&gt;<i>
</I>
Just for reference the exploit with short_channel_ids is known since 2019:

<A HREF="https://github.com/lightning/bolts/issues/675">https://github.com/lightning/bolts/issues/675</A>

Though it is nice you point out explicitly the use of error codes of
onions.


&gt;<i> By creating a probe guessing the Channel ID based on unspent p2wsh
</I>&gt;<i> transactions, it's a `m * n` problem to probe the entire network, where `m`
</I>&gt;<i> is utxos and `n` is nodes.
</I>&gt;<i>
</I>
It is the main reason why I didn't do this. Though similar to you probing
ACINQ's node one could probabilistically learn which nodes tend to have
unannounced channels and gain some speedup by probing those nodes first.

Also wallets tend to have poor utxo management. So looking at the on-chain
signal one can probably guess for a p2wsh to which two nodes it might
belong and try them first.

These two strategies should reduce the number of tested nodes for a newly
seen p2wsh output significantly and probably make it feasible to probe the
network as new blocks come in.

With kind regards Rene Pickhardt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20220608/08a200ad/attachment.html">http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20220608/08a200ad/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003602.html">[Lightning-dev] Preliminary Hidden Lightning Network Analysis
</A></li>
	<LI>Next message: <A HREF="003604.html">[Lightning-dev] Preliminary Hidden Lightning Network Analysis
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3603">[ date ]</a>
              <a href="thread.html#3603">[ thread ]</a>
              <a href="subject.html#3603">[ subject ]</a>
              <a href="author.html#3603">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
