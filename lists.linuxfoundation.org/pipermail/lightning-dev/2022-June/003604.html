<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Preliminary Hidden Lightning Network Analysis
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2022-June/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Preliminary%20Hidden%20Lightning%20Network%20Analysis&In-Reply-To=%3CrIWfNWJS5ckCfD3utf8SI-_VzW2YLLWcszQUlXV-4BI0mxUh0OsapHj9xUBZ4Z5UV1FlJvQSb5EIV7W7AMxcZEKhzjS37pqWPVVTsGAP57c%3D%40protonmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003603.html">
   <LINK REL="Next"  HREF="003600.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Preliminary Hidden Lightning Network Analysis</H1>
    <B>Tony Giorgio</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Preliminary%20Hidden%20Lightning%20Network%20Analysis&In-Reply-To=%3CrIWfNWJS5ckCfD3utf8SI-_VzW2YLLWcszQUlXV-4BI0mxUh0OsapHj9xUBZ4Z5UV1FlJvQSb5EIV7W7AMxcZEKhzjS37pqWPVVTsGAP57c%3D%40protonmail.com%3E"
       TITLE="[Lightning-dev] Preliminary Hidden Lightning Network Analysis">tonygiorgio at protonmail.com
       </A><BR>
    <I>Mon Jun 13 16:58:31 UTC 2022</I>
    <P><UL>
        <LI>Previous message: <A HREF="003603.html">[Lightning-dev] Preliminary Hidden Lightning Network Analysis
</A></li>
        <LI>Next message: <A HREF="003600.html">[Lightning-dev] LN Summit 2022 Notes &amp; Summary/Commentary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3604">[ date ]</a>
              <a href="thread.html#3604">[ thread ]</a>
              <a href="subject.html#3604">[ subject ]</a>
              <a href="author.html#3604">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Rene,

Thanks for your reply.

&gt;<i> Also wallets tend to have poor utxo management. So looking at the on-chain signal one can probably guess for a p2wsh to which two nodes it might belong and try them first.
</I>
&#8203;
That was going to be one of my next steps. I thought about parsing through the data from <A HREF="https://github.com/lnresearch/topology">https://github.com/lnresearch/topology</A> in order to get a link between every unpsent p2wsh transaction up to 6 hops forward from the opening transaction between two nodes. Then keep a list of every node and their possible p2wsh transactions and probe with those. Should cut down a lot but I have not run through this dataset problem yet. Curious if you think that would be the best process moving forward with this.

Otherwise, going through LSP's with the assumption set, like I did with ACINQ would probably yield further results.

Regards,
Tony
------- Original Message -------
On Wednesday, June 8th, 2022 at 12:42 AM, Ren&#233; Pickhardt &lt;<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">r.pickhardt at googlemail.com</A>&gt; wrote:

&gt;<i> Dear Tony,
</I>&gt;<i>
</I>&gt;<i> Thank you for putting emphasis on this. I was actually waiting for someone to publicly exploit this.
</I>&gt;<i>
</I>&gt;&gt;<i> The reason this is possible is because [...] currently channel IDs are based on UTXO's. Scid aliases may be the biggest benefit here, but the use of `unknown_next_peer` , `invalid_onion_hmac`, `incorrect_cltv_expiry`, and `amount_below_minimum` have been the biggest helpers in exploiting channel privacy.
</I>&gt;<i>
</I>&gt;<i> Just for reference the exploit with short_channel_ids is known since 2019:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://github.com/lightning/bolts/issues/675">https://github.com/lightning/bolts/issues/675</A>
</I>&gt;<i>
</I>&gt;<i> Though it is nice you point out explicitly the use of error codes of onions.
</I>&gt;<i>
</I>&gt;&gt;<i> By creating a probe guessing the Channel ID based on unspent p2wsh transactions, it's a `m * n` problem to probe the entire network, where `m` is utxos and `n` is nodes.
</I>&gt;<i>
</I>&gt;<i> It is the main reason why I didn't do this. Though similar to you probing ACINQ's node one could probabilistically learn which nodes tend to have unannounced channels and gain some speedup by probing those nodes first.
</I>&gt;<i>
</I>&gt;<i> Also wallets tend to have poor utxo management. So looking at the on-chain signal one can probably guess for a p2wsh to which two nodes it might belong and try them first.
</I>&gt;<i>
</I>&gt;<i> These two strategies should reduce the number of tested nodes for a newly seen p2wsh output significantly and probably make it feasible to probe the network as new blocks come in.
</I>&gt;<i>
</I>&gt;<i> With kind regards Rene Pickhardt
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20220613/10ec2bcf/attachment.html">http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20220613/10ec2bcf/attachment.html</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003603.html">[Lightning-dev] Preliminary Hidden Lightning Network Analysis
</A></li>
	<LI>Next message: <A HREF="003600.html">[Lightning-dev] LN Summit 2022 Notes &amp; Summary/Commentary
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3604">[ date ]</a>
              <a href="thread.html#3604">[ thread ]</a>
              <a href="subject.html#3604">[ subject ]</a>
              <a href="author.html#3604">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
