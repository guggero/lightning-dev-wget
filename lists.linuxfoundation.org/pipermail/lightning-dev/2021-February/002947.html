<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Lightning-dev Digest, Vol 66, Issue 4
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2021-February/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Lightning-dev%20Digest%2C%20Vol%2066%2C%20Issue%204&In-Reply-To=%3CCAKwEHpjOvqa1DQhz6tqo6CCTpNqiy71vqGu4%2BkSHmzeqfbMAKQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002951.html">
   <LINK REL="Next"  HREF="002948.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Lightning-dev Digest, Vol 66, Issue 4</H1>
    <B>Joe Miyamoto Philips</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Lightning-dev%20Digest%2C%20Vol%2066%2C%20Issue%204&In-Reply-To=%3CCAKwEHpjOvqa1DQhz6tqo6CCTpNqiy71vqGu4%2BkSHmzeqfbMAKQ%40mail.gmail.com%3E"
       TITLE="[Lightning-dev] Lightning-dev Digest, Vol 66, Issue 4">joemphilips at gmail.com
       </A><BR>
    <I>Fri Feb  5 13:02:42 UTC 2021</I>
    <P><UL>
        <LI>Previous message: <A HREF="002951.html">[Lightning-dev] Pay-for-Elgamal-decryption-key and its application to Anonymous Credentials
</A></li>
        <LI>Next message: <A HREF="002948.html">[Lightning-dev] Escrow Over Lightning?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2947">[ date ]</a>
              <a href="thread.html#2947">[ thread ]</a>
              <a href="subject.html#2947">[ subject ]</a>
              <a href="author.html#2947">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>  If a malicious credential server is
</I>able to identify you somehow at the point of payment then they might want
&gt;<i> to selectively steal your money while being honest with everyone else.
</I>&gt;<i> In your scheme, if you pay you get the credential and then since it is
</I>anonymous it can't be distinguished from others when you go to claim
whatever it entails.
&gt;<i> Is this the idea?
</I>
Yes, And in case of a trustful exchange with LN, the malicious server does
not even have to distinguish a user. The server can just choose one private
channel that is connected to itself and decides to be dishonest to it.
The victim has no way to prove that he did NOT receive a credential after
payment.

Thus I think making an exchange atomic is necessary in a commercial
application.



On Fri, Feb 5, 2021 at 9:00 PM &lt;
<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">lightning-dev-request at lists.linuxfoundation.org</A>&gt; wrote:

&gt;<i> Send Lightning-dev mailing list submissions to
</I>&gt;<i>         <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">lightning-dev at lists.linuxfoundation.org</A>
</I>&gt;<i>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i>         <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i>         <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">lightning-dev-request at lists.linuxfoundation.org</A>
</I>&gt;<i>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i>         <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">lightning-dev-owner at lists.linuxfoundation.org</A>
</I>&gt;<i>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;<i> than &quot;Re: Contents of Lightning-dev digest...&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Today's Topics:
</I>&gt;<i>
</I>&gt;<i>    1. Re: Pay-for-Elgamal-decryption-key and its application to
</I>&gt;<i>       Anonymous Credentials (Lloyd Fournier)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Fri, 5 Feb 2021 11:05:58 +1100
</I>&gt;<i> From: Lloyd Fournier &lt;<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">lloyd.fourn at gmail.com</A>&gt;
</I>&gt;<i> To: ??? &lt;<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">joe.miyamoto at bitcoinbank.co.jp</A>&gt;
</I>&gt;<i> Cc: &quot;lightning-dev\\\\@lists.linuxfoundation.org&quot;
</I>&gt;<i>         &lt;<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">lightning-dev at lists.linuxfoundation.org</A>&gt;
</I>&gt;<i> Subject: Re: [Lightning-dev] Pay-for-Elgamal-decryption-key and its
</I>&gt;<i>         application to Anonymous Credentials
</I>&gt;<i> Message-ID:
</I>&gt;<i>         &lt;CAH5Bsr2b+1r=
</I>&gt;<i> <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">KOG+eQWBYNMZuwkaHZvsR1O+6bWaGqym6r9c6w at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;utf-8&quot;
</I>&gt;<i>
</I>&gt;<i> Hi Miyamoto,
</I>&gt;<i>
</I>&gt;<i> Very interesting idea :)
</I>&gt;<i> Usually when dealing with anonymous credentials you are necessarily dealing
</I>&gt;<i> with a trusted third party so it's fine to just make a normal payment and
</I>&gt;<i> then receive the credential after successfully paying.
</I>&gt;<i> But I see the advantage of your idea. If a malicious credential server is
</I>&gt;<i> able to identify you somehow at the point of payment then they might want
</I>&gt;<i> to selectively steal your money while being honest with everyone else.
</I>&gt;<i> In your scheme, if you pay you get the credential and then since it is
</I>&gt;<i> anonymous it can't be distinguished from others when you go to claim
</I>&gt;<i> whatever it entails.
</I>&gt;<i> Is this the idea?
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>&gt;<i> LL
</I>&gt;<i>
</I>&gt;<i> On Thu, Feb 4, 2021 at 1:04 PM ??? via Lightning-dev &lt;
</I>&gt;<i> <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">lightning-dev at lists.linuxfoundation.org</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hi all.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I want to point out another application of Discrete-Log selling on PTLC
</I>&gt;<i> &gt; lightning since I could not find anyone else mentioning it (in
</I>&gt;<i> particular,
</I>&gt;<i> &gt; I could not find in the Nadav Kohen's list here. [1] )
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The protocol may be obvious to most of the members here, but I believe
</I>&gt;<i> its
</I>&gt;<i> &gt; application has some impact on the way people make anonymity-focused
</I>&gt;<i> &gt; applications with LN, so I want to have some feedback.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In short, by using ElGamal encryption, we can sell not only a
</I>&gt;<i> discrete-log
</I>&gt;<i> &gt; but also an elliptic curve point which satisfies some requirements. This
</I>&gt;<i> &gt; includes KVAC [2] which is used for WabiSabi [3] and Signal app [4].
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; disclaimer: I'm not a cryptography or math major, the following
</I>&gt;<i> &gt; reasoning might be wrong at the fundamental level. Please correct me if
</I>&gt;<i> I'm
</I>&gt;<i> &gt; wrong.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ## Notations
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; * G ... Elliptic curve base point.
</I>&gt;<i> &gt; * H ... some additional NUMS
</I>&gt;<i> &gt; * x, X = x * G ... secret and public key
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; For ZKPoK, I will use Camenisch-Stadler like notation
</I>&gt;<i> &gt; PK{ (secret values) : statements about secret values to prove. }
</I>&gt;<i> &gt; e.g. For DLEQ proof. assume the verifier already have some points P_1,
</I>&gt;<i> P_2
</I>&gt;<i> &gt; PK{ (x, y) : P_1 =  x * G and P_2 = y * H and x = y }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; # Protocols
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ## pay-for ElGamal decryption key
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Quick recap, ElGamal encryption for message M (= m * G) is
</I>&gt;<i> &gt; (r * G, M + r * P)
</I>&gt;<i> &gt; where r is some blinding factor and P is a shared secret (P = p * G)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Imagine the Buyer knows some point (X_h = x * H), and he wants another
</I>&gt;<i> &gt; point (X_g  = x * G).
</I>&gt;<i> &gt; The Seller knows x and he wants to sell the point X_g but he does NOT
</I>&gt;<i> want
</I>&gt;<i> &gt; to reveal its discrete log x to the buyer.
</I>&gt;<i> &gt; (There is not much of a situation like this, but I will explain it
</I>&gt;<i> later.)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; In this case, the Seller can send its elgamal encryption and sell its
</I>&gt;<i> &gt; decryption key.
</I>&gt;<i> &gt; Seller:
</I>&gt;<i> &gt; * Generate ephemeral encryption key S = s * G
</I>&gt;<i> &gt; * Encrypt X_g  with random blinding r ... (c1, c2) := (r * G, X_g + r *
</I>&gt;<i> S)
</I>&gt;<i> &gt; * Send (c1, c2) and S to the Buyer.
</I>&gt;<i> &gt; * Also, send PK{(x, r, s) :  c1 = r * G and c2 = x * G + r * S and X_h =
</I>&gt;<i> x
</I>&gt;<i> &gt; * H }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Buyer
</I>&gt;<i> &gt; * Verifies the ZKPoK, he can be sure that the plaintext will be X_g that
</I>&gt;<i> &gt; he wants.
</I>&gt;<i> &gt; * Make a payment offer to the Seller with S.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Seller
</I>&gt;<i> &gt; * Receive the payment by revealing s
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Buyer
</I>&gt;<i> &gt; * Decrypt the ciphertext by s to get the X_g ... (X_g := c2 - c1 * s)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; ## Pay for Keyed Verification Anonymous Credential. (KVAC)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; We assume MAC_{GGM} scheme for the KVAC. [2]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; * attributes encoded in the credential is m_1, ... m_n
</I>&gt;<i> &gt; * secret keys for the issuer=verifier is r, x_0, x_1, ... x_n
</I>&gt;<i> &gt; * Public params for the issuer is (C_x0 = x_0 * G + r * H), (X_1 = x_1 *
</I>&gt;<i> &gt; G, ... X_n = x_n * G)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The credential is of the form (U, U') where U' = U * (x_0 + x_1 * m_1 +
</I>&gt;<i> &gt; ... + x_n * m_n)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Issuer:
</I>&gt;<i> &gt; * get random point `U`
</I>&gt;<i> &gt; * compute U' = U * (x_0 + x_1 * m_1 + ... + x_n + m_n)
</I>&gt;<i> &gt; * sends U and ElGamal encryption of U' to the Buyer with blinding factor
</I>&gt;<i> k
</I>&gt;<i> &gt; and ephemeral encryption key S.
</I>&gt;<i> &gt;   * (c1, c2) = (k * G, U' + k * S)
</I>&gt;<i> &gt; * Also send ZKPoK to tell the ciphertext is for correct U'
</I>&gt;<i> &gt;   * PK{(x_0, ... x_n, x_0, r, k, s) :  U' = U * (x_0 + x_1 * m_1 + ... +
</I>&gt;<i> &gt; x_n * m_n)  and  C_x0 = G * x_0 + H * r and X_1 = x_1 * G and ... and
</I>&gt;<i> X_n =
</I>&gt;<i> &gt; x_n * G and  c1 = k * G and c2 = U' + k * S }
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Then Buyer can buy s as the same as above.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; # Why this matters
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I believe that KVAC has great potential as a building block of anonymous
</I>&gt;<i> &gt; web apps.
</I>&gt;<i> &gt; Its MAC-based construction is more performant and easy to prove the
</I>&gt;<i> &gt; security compared to the similar system for the PKI based anonymous
</I>&gt;<i> &gt; credentials (e.g. U-Prove [5] and ACL [6]).
</I>&gt;<i> &gt; And it's a great fit for commercial purpose applications which do not
</I>&gt;<i> have
</I>&gt;<i> &gt; to cooperate with other entities when defining the protocol. (Which is
</I>&gt;<i> not
</I>&gt;<i> &gt; the case for an Attribute based credential system in general.)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The reason so far it has not been used widely is, IMHO, it's because
</I>&gt;<i> there
</I>&gt;<i> &gt; is no way to charge its users anonymously. [7]
</I>&gt;<i> &gt; Another problem is Sybil attack. In general, the DoS protection is a
</I>&gt;<i> great
</I>&gt;<i> &gt; concern for anonymous applications.
</I>&gt;<i> &gt; So we need users to commit something &quot;scarce&quot; to prevent it.
</I>&gt;<i> &gt; It is why Signal requires its users to register their telephone number
</I>&gt;<i> &gt; (Maybe I'm wrong about this, not sure).
</I>&gt;<i> &gt; (WabiSabi cleverly uses the user's UTXO as the scarce resource to
</I>&gt;<i> mitigate
</I>&gt;<i> &gt; this problem.)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; And of course, these problems get fixed by LN, if users have to pay to
</I>&gt;<i> get
</I>&gt;<i> &gt; their service, the service does not have to ban the users by DoS-ing
</I>&gt;<i> &gt; anymore. So I think the LN-based payment and KVAC-based app fits very
</I>&gt;<i> well.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thus, if the service wants to grant some right to do something with their
</I>&gt;<i> &gt; server resource to users in an unlinkable fashion, then I believe
</I>&gt;<i> &gt; exchanging the credential in this way has a benefit.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Miyamoto.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [1]:
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="../2020-April/002647.html">https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-April/002647.html</A>
</I>&gt;<i> &gt; [2]: <A HREF="https://eprint.iacr.org/2013/516.pdf">https://eprint.iacr.org/2013/516.pdf</A>
</I>&gt;<i> &gt; [3]: <A HREF="https://github.com/zkSNACKs/WabiSabi">https://github.com/zkSNACKs/WabiSabi</A>
</I>&gt;<i> &gt; [4]: <A HREF="https://signal.org/blog/pdfs/signal_private_group_system.pdf">https://signal.org/blog/pdfs/signal_private_group_system.pdf</A>
</I>&gt;<i> &gt; [5]: <A HREF="https://www.microsoft.com/en-us/research/project/u-prove/">https://www.microsoft.com/en-us/research/project/u-prove/</A>
</I>&gt;<i> &gt; [6]: <A HREF="https://core.ac.uk/download/pdf/193377167.pdf">https://core.ac.uk/download/pdf/193377167.pdf</A>
</I>&gt;<i> &gt; [7]: DuckDuckGo has an interesting solution for this. But it is not a
</I>&gt;<i> &gt; general solution for all kinds of apps and I doubt how good it works.
</I>&gt;<i> &gt; <A HREF="https://spreadprivacy.com/duckduckgo-revenue-model/">https://spreadprivacy.com/duckduckgo-revenue-model/</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Lightning-dev mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">Lightning-dev at lists.linuxfoundation.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev</A>
</I>&gt;<i> &gt;
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> An HTML attachment was scrubbed...
</I>&gt;<i> URL: &lt;
</I>&gt;<i> <A HREF="http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20210205/8001a145/attachment-0001.html">http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20210205/8001a145/attachment-0001.html</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> Subject: Digest Footer
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Lightning-dev mailing list
</I>&gt;<i> <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">Lightning-dev at lists.linuxfoundation.org</A>
</I>&gt;<i> <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i> End of Lightning-dev Digest, Vol 66, Issue 4
</I>&gt;<i> ********************************************
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20210205/057d9dd8/attachment.html">http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20210205/057d9dd8/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002951.html">[Lightning-dev] Pay-for-Elgamal-decryption-key and its application to Anonymous Credentials
</A></li>
	<LI>Next message: <A HREF="002948.html">[Lightning-dev] Escrow Over Lightning?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2947">[ date ]</a>
              <a href="thread.html#2947">[ thread ]</a>
              <a href="subject.html#2947">[ subject ]</a>
              <a href="author.html#2947">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
