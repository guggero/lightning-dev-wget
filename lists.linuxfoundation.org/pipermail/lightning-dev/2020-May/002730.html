<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Griefing-Penalty: A proposal for mitigating Griefing Attack
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-May/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Griefing-Penalty%3A%20A%20proposal%20for%20mitigating%0A%20Griefing%20Attack&In-Reply-To=%3CCAPvY%3DRgsjSdVGDgv%2Bc58AKGNJPPoMdvep5kfw12%3D8Sbb-CbTzw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002729.html">
   <LINK REL="Next"  HREF="002731.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Griefing-Penalty: A proposal for mitigating Griefing Attack</H1>
    <B>Subhra Mazumdar</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Griefing-Penalty%3A%20A%20proposal%20for%20mitigating%0A%20Griefing%20Attack&In-Reply-To=%3CCAPvY%3DRgsjSdVGDgv%2Bc58AKGNJPPoMdvep5kfw12%3D8Sbb-CbTzw%40mail.gmail.com%3E"
       TITLE="[Lightning-dev] Griefing-Penalty: A proposal for mitigating Griefing Attack">subhra.mazumdar1993 at gmail.com
       </A><BR>
    <I>Sat May 30 14:52:37 UTC 2020</I>
    <P><UL>
        <LI>Previous message: <A HREF="002729.html">[Lightning-dev] Griefing-Penalty: A proposal for mitigating	Griefing Attack
</A></li>
        <LI>Next message: <A HREF="002731.html">[Lightning-dev] Griefing-Penalty: A proposal for mitigating	Griefing Attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2730">[ date ]</a>
              <a href="thread.html#2730">[ thread ]</a>
              <a href="subject.html#2730">[ subject ]</a>
              <a href="author.html#2730">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi ZmnSCPxj,

Thanks for the feedback. The 1000 block relative confirmation time was just
a representative value, as stated in [1]. We acknowledge that practical
implementations have much lesser confirmation times.
&gt;<i> Yes, to earn by reverse-griefing you can need to trigger the channel to
</I>be closed, but even if you leave it open, there is a chance the
counterparty will close it for no reason it will bother to explain to you.

The possibility exists. Noted.

&gt;<i> Can you describe this in more detail?
</I>Here is our proposal for mitigating reverse-griefing
<A HREF="https://gist.github.com/subhramazumdar/cf7b043a73db136f6a23091d20e51751">https://gist.github.com/subhramazumdar/cf7b043a73db136f6a23091d20e51751</A>
Looking forward to your comments.

[1] Poon, J. and Dryja, T., 2016. The bitcoin lightning network: Scalable
off-chain instant payments.
&lt;<A HREF="https://lightning.network/lightning-network-paper.pdf">https://lightning.network/lightning-network-paper.pdf</A>&gt;

On Sat, May 30, 2020 at 11:35 AM ZmnSCPxj &lt;<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">ZmnSCPxj at protonmail.com</A>&gt; wrote:

&gt;<i> Good morning Subhra,
</I>&gt;<i>
</I>&gt;<i> &gt; -   Myopic strategy: An adversary makes short-term gain by
</I>&gt;<i> reverse-griefing but loses in the long term because of waiting time
</I>&gt;<i> involved in earning the profit and also due to closure of channel.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -   Long-term strategy: If a strategy provides short term gain but
</I>&gt;<i> incurs a substantial loss in the long term without fulfilling any of the
</I>&gt;<i> objectives of griefing attack, the adversary would choose not to deviate
</I>&gt;<i> from the protocol and behave honestly.
</I>&gt;<i>
</I>&gt;<i> What mechanism protects against the myopic strategy?
</I>&gt;<i>
</I>&gt;<i> There are many reasons why getting short-term gains *right now* via
</I>&gt;<i> reverse-griefing is generally better:
</I>&gt;<i>
</I>&gt;<i> * Time discounting.
</I>&gt;<i>   Money you have now is better than money you will have in the future,
</I>&gt;<i> because you can immediately reinvest the money right now.
</I>&gt;<i>   Thus, future earnings must be discounted by the expected average return
</I>&gt;<i> on investment compared to current earnings.
</I>&gt;<i> * Counterparty risk.
</I>&gt;<i>   Even if you maintain the channel open in the hope of future earnings,
</I>&gt;<i> the counterparty can very well just close the channel at any time for no
</I>&gt;<i> discernible reason.
</I>&gt;<i>   This reduces the expected return on investment by honest behavior.
</I>&gt;<i> * Cheap pseudonyms.
</I>&gt;<i>   All you need is to get 256 bits of entropy and you can connect as a
</I>&gt;<i> different node.
</I>&gt;<i>   VPNs and cloud servers can make it difficult to nail down specific IP
</I>&gt;<i> addresses as belonging to you as attacker.
</I>&gt;<i>
</I>&gt;<i> My reading of the paper suggests that you simply assume that the honest
</I>&gt;<i> strategy will earn more economically than reverse-griefing; can you provide
</I>&gt;<i> expected return of investment on other possible investments (e.g. running a
</I>&gt;<i> JoinMarket maker) to determine time discounting, and the rate at which
</I>&gt;<i> channels get closed for no good reason to check counterparty risk?
</I>&gt;<i>
</I>&gt;<i> The fact that a reverse-griefing becomes possible means that, even after
</I>&gt;<i> ignoring onchain fees, running a node can lead to a negative return on
</I>&gt;<i> investment, whereas with current Lightning, if we ignore onchain fees, the
</I>&gt;<i> minimum return on investment is 0 and you can &quot;only&quot; earn (again,
</I>&gt;<i> emphasizing that this holds only if we ignore onchain fees; but in any
</I>&gt;<i> case, with reverse-griefing possible, this can potentially give even worse
</I>&gt;<i> negative return on investment if the node is attacked by reverse-griefing).
</I>&gt;<i>
</I>&gt;<i> Griefing can only prevent you from earning.
</I>&gt;<i> Reverse-griefing can lose you funds.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; &gt; Rationality requires some goal to work toward. Often, the goal is
</I>&gt;<i> &quot;look out for number one&quot; i.e. be selfish. Thus, an economically rational
</I>&gt;<i> selfish entity is not a contradiction in terms: instead, it is simply
</I>&gt;<i> applying its rationality towards its own self-interest.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Using the term &#8220;rational and selfish&#8221; in the Discussion was a poor
</I>&gt;<i> choice of words. Thanks for pointing it out. We define an honest-rational
</I>&gt;<i> party as someone who follows the protocol unless a strictly more rewarding
</I>&gt;<i> strategy exists. In our paper, an honest-rational party will follow the
</I>&gt;<i> protocol as the profit earned by processing several transactions is greater
</I>&gt;<i> than the profit earned by reverse-griefing.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; So if an honestly-self-rational node could be tempted to setting up
</I>&gt;<i> reverse-griefing attacks, it seems to me that grief-penalty cannot work
</I>&gt;<i> well as a solution to griefing.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Apart from earning less profit, there are several factors which justify
</I>&gt;<i> why an honest rational party would prefer to follow the protocol rather
</I>&gt;<i> than turn malicious and follow a myopic strategy (i.e resort to
</I>&gt;<i> reverse-griefing):
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1.  A party who tries to reverse-grief has to wait for the expiration of
</I>&gt;<i> the off-chain contract&#8217;s locktime before it can broadcast the transaction
</I>&gt;<i> for earning a penalty.
</I>&gt;<i>
</I>&gt;<i> But an honest node that hopes to continuously earn money may need to wait
</I>&gt;<i> even longer before somebody forwards through them, and is generally paid
</I>&gt;<i> only a few dozen millisatoshi each time.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; 2.  Note that this output again is encumbered by the RSMC (1000 block
</I>&gt;<i> relative confirmation times as stated in [1]) This means that it has to
</I>&gt;<i> wait for 1000 blocks after broadcasting the penalty transaction before it
</I>&gt;<i> can actually spend the output.
</I>&gt;<i>
</I>&gt;<i> I am unaware of any modern implementation that uses timelocks that large.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 3.  The fund locked in the contract, which acts as compensation in case
</I>&gt;<i> of misbehavior, is a substantial amount. Definitely, an intermediate party
</I>&gt;<i> won&#8217;t keep its funds unutilized and try to resolve payment as soon as
</I>&gt;<i> possible.
</I>&gt;<i>
</I>&gt;<i> Like I pointed out elsewhere, griefing attacks are attacks committed by
</I>&gt;<i> payer/payee conspiracies against forwarding nodes; we can disregard this
</I>&gt;<i> point since it applies to non-griefing-penalty (i.e. current Lightning)
</I>&gt;<i> just as well.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt; 4.  It leads to channel closure. Any operation performed on-chain is a
</I>&gt;<i> costly affair.  A rational party will not prefer to close the channel.
</I>&gt;<i>
</I>&gt;<i> And like I pointed out, because any counterparty can close its channel
</I>&gt;<i> with you at any time, this risk can be discounted by the expected average
</I>&gt;<i> chance that a counterparty will close the channel for no reason.
</I>&gt;<i> Yes, to earn by reverse-griefing you can need to trigger the channel to be
</I>&gt;<i> closed, but even if you leave it open, there is a chance the counterparty
</I>&gt;<i> will close it for no reason it will bother to explain to you.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thus an honest-rational party can earn in either of the two ways:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 1.  A fee for processing payments.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; 2.  If affected by griefing attack, it gets compensated for the
</I>&gt;<i> collateral loss.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; Given we route using onion routing, it would be trivial to create a
</I>&gt;<i> loop in the route so that the same node occurs twice in it, thus trivially
</I>&gt;<i> meeting the &quot;at least two nodes in the path must be corrupted&quot; requirement.
</I>&gt;<i> That is, the sender and the receiver can be the same node, making it appear
</I>&gt;<i> twice in the path.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Our assumption that at most one party is corrupted under adversarial
</I>&gt;<i> model holds true for self-payment. Please refer to Corollary 1 of our
</I>&gt;<i> Security Analysis section in the paper.
</I>&gt;<i>
</I>&gt;<i> Okay.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; The solution should really prevent griefing without introducing any
</I>&gt;<i> reverse-griefing.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; To avoid reverse-griefing, we may add an extra round (as preprocessing
</I>&gt;<i> step) before initiating the lock phase. Additionally, the off-chain
</I>&gt;<i> contract might contain two hashes: one for normal payment and one for
</I>&gt;<i> error. Thanks to Rene Pickhardt for his suggestions.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Can you describe this in more detail?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> ZmnSCPj
</I>&gt;<i>
</I>

-- 
Yours sincerely,
Subhra Mazumdar.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20200530/aa9aa0bd/attachment.html">http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20200530/aa9aa0bd/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002729.html">[Lightning-dev] Griefing-Penalty: A proposal for mitigating	Griefing Attack
</A></li>
	<LI>Next message: <A HREF="002731.html">[Lightning-dev] Griefing-Penalty: A proposal for mitigating	Griefing Attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2730">[ date ]</a>
              <a href="thread.html#2730">[ thread ]</a>
              <a href="subject.html#2730">[ subject ]</a>
              <a href="author.html#2730">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
