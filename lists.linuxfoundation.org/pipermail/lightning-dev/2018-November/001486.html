<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Proposal for &quot;local&quot; channel announcements.
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-November/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Proposal%20for%20%22local%22%20channel%20announcements.&In-Reply-To=%3C87va5hfrog.fsf%40rustcorp.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001549.html">
   <LINK REL="Next"  HREF="001492.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Proposal for &quot;local&quot; channel announcements.</H1>
    <B>Rusty Russell</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Proposal%20for%20%22local%22%20channel%20announcements.&In-Reply-To=%3C87va5hfrog.fsf%40rustcorp.com.au%3E"
       TITLE="[Lightning-dev] Proposal for &quot;local&quot; channel announcements.">rusty at rustcorp.com.au
       </A><BR>
    <I>Thu Nov  1 02:38:23 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="001549.html">[Lightning-dev] RFC: simplifications and suggestions on open/accept limits.
</A></li>
        <LI>Next message: <A HREF="001492.html">[Lightning-dev] Proposal for &quot;local&quot; channel announcements.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1486">[ date ]</a>
              <a href="thread.html#1486">[ thread ]</a>
              <a href="subject.html#1486">[ subject ]</a>
              <a href="author.html#1486">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm not sure if this is too large a hammer for a small problem, but I
thought it worth writing up.

Currently, a node with only private channels loses deniability of
payments; if you have an unannounced channel with me, I can be fairly
sure any payment I see coming from that channel is from you (in theory
you could have used 'r' hints to convince someone to send a payment
though you, but that requires boutique arrangements).

If we create &quot;local&quot; channel announcements, which only propagate one
hop, this deniability increases.  The mechanism would look something
like this.

1. type: 267 (`local_channel_id`)
2. data:
    * [`32`:`channel_id`]
    * [`8`:`fake_short_channel_id`]

The public node would suggest a fake short channel id (which it would
choose to be unique to it).  If it wants, to the private node would
reply with:

1. type: 268 (`local_channel_id_signatures`)
2. data:
    * [`32`:`channel_id`]
    * [`8`:`fake_short_channel_id`]
    * [`32`:`fake_node_id`]
    * [`64`:`node_signature`]

The `fake_node_id` is the node_id which the private node wants to use
for the channel_announcement (it might be its real id, might not).  The
`node_signature` is its signaure on the `local_channel_announcement`
message using that key.

1. type: 269 (`local_channel_announcement`)
2. data:
    * [`64`:`node_signature_1`]
    * [`64`:`node_signature_2`]
    * [`2`:`len`]
    * [`len`:`features`]
    * [`32`:`chain_hash`]
    * [`8`:`short_channel_id`]
    * [`33`:`other_node_id`]

This is like `channel_announcement` without claiming a specific bitcoin
funding transaction, and with one 'node_id' implied by who you receive
it from.  This would be generated by the public node, and sent to its
peers: they MAY treat it as a valid channel_announcement, but SHOULD NOT
propagate it (in fact, it can't be propagated).

Now, `channel_update` works as before, with a similar non-propagation
rule.

Feedback welcome!
Rusty.
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001549.html">[Lightning-dev] RFC: simplifications and suggestions on open/accept limits.
</A></li>
	<LI>Next message: <A HREF="001492.html">[Lightning-dev] Proposal for &quot;local&quot; channel announcements.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1486">[ date ]</a>
              <a href="thread.html#1486">[ thread ]</a>
              <a href="subject.html#1486">[ subject ]</a>
              <a href="author.html#1486">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
