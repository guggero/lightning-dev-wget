<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] A proposal for up-front payments.
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-November/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20A%20proposal%20for%20up-front%20payments.&In-Reply-To=%3CCAJBJmV81M6j7U_1CzX1qjfrbpyTcviLqpSTH7XgE5Y8j_jUBJA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002301.html">
   <LINK REL="Next"  HREF="002276.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] A proposal for up-front payments.</H1>
    <B>Joost Jager</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20A%20proposal%20for%20up-front%20payments.&In-Reply-To=%3CCAJBJmV81M6j7U_1CzX1qjfrbpyTcviLqpSTH7XgE5Y8j_jUBJA%40mail.gmail.com%3E"
       TITLE="[Lightning-dev] A proposal for up-front payments.">joost.jager at gmail.com
       </A><BR>
    <I>Fri Nov  8 14:45:08 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="002301.html">[Lightning-dev] A proposal for up-front payments.
</A></li>
        <LI>Next message: <A HREF="002276.html">[Lightning-dev] [VERY ROUGH DRAFT] BOLT 12: Offers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2309">[ date ]</a>
              <a href="thread.html#2309">[ thread ]</a>
              <a href="subject.html#2309">[ subject ]</a>
              <a href="author.html#2309">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>&gt;<i>
</I>&gt;<i> &gt;&gt; &gt; Isn't spam something that can also be addressed by using rate limits
</I>&gt;<i> for
</I>&gt;<i> &gt;&gt; &gt; failures? If all relevant nodes on the network employ rate limits,
</I>&gt;<i> they
</I>&gt;<i> &gt;&gt; can
</I>&gt;<i> &gt;&gt; &gt; isolate the spammer and diminish their disruptive abilities.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Sure, once the spammer has jammed up the network, he'll be stopped.  So
</I>&gt;<i> &gt;&gt; will everyone else.  Conner had a proposal like this which didn't work,
</I>&gt;<i> &gt;&gt; IIRC.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Do you have ref to this proposal?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Imagine the following setup: a network of nodes that trust each other (as
</I>&gt;<i> &gt; far as spam is concerned) applies a 100 htlc/sec rate limit to the
</I>&gt;<i> channels
</I>&gt;<i> &gt; between themselves. Channels to untrusted nodes get a rate of only 1
</I>&gt;<i> &gt; htlc/sec. Assuming the spammer isn't a trusted node, they can only spam
</I>&gt;<i> at
</I>&gt;<i> &gt; 1 htlc/s and won't jam up the network?
</I>&gt;<i>
</I>&gt;<i> Damn, I searched for it but all the obvious keywords turned up blank.
</I>&gt;<i> Conner CC'd in case he remembers the discussion and I'm not imagining it?
</I>&gt;<i>
</I>&gt;<i> Anyway, if there are 100 nodes in the network I can still open a channel
</I>&gt;<i> to each one and jam it up immediately.  And that's not even assuming I
</I>&gt;<i> play nice until you trust me, then attack or get taken over.
</I>

At least it has gotten (100 times?) more difficult. I think it is hard to
say upfront how good or bad this setup would work. But I agree that prepay
deters spam in a more fundamental way.

Besides the argument that I brought up earlier of potentially killing
micro-payment-based use cases with prepay, there is also another concern.
It is nothing new, but could be interesting to look at it in the light of
prepayments.

It is currently possible to jam a channel with very limited resources. If
you hold 483 htlcs on a channel, it has become unusable for up to the cltv
limit. Let's say for 1000 blocks. If you allow a route that ping pongs back
and forth on the channel (let's say 8 times back and forth), you only need
to send 60 htlcs of the minimum amount for the route to jam the channel
completely. With min htlc policies of 1 sat, that will lock up only 60 sats
of the attacker (assuming no routing fees).

Let's say the wumbo channel has a capacity of 1 btc. Locking up 1 btc for
1000 blocks (~1 week) and assuming a time value of 4% per annum, the cost
to the routing node is: 1 * (1.04 ^ (1/52)) - 1 = 75,000 sats.

How much prepay would you need to prevent this? I don't think the 50 msat
would cut it.

I know this is the liquidity-using class of spam, but if prepay cannot
prevent this I think it is better to first address this class. And once
there is solution for that, see whether the other classes of spam are still
possible.

Joost
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20191108/70b303c9/attachment.html">http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20191108/70b303c9/attachment.html</A>&gt;
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002301.html">[Lightning-dev] A proposal for up-front payments.
</A></li>
	<LI>Next message: <A HREF="002276.html">[Lightning-dev] [VERY ROUGH DRAFT] BOLT 12: Offers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2309">[ date ]</a>
              <a href="thread.html#2309">[ thread ]</a>
              <a href="subject.html#2309">[ subject ]</a>
              <a href="author.html#2309">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
