<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Suggestion: Add optional IP address field to	invoice format
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2018-January/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Suggestion%3A%20Add%20optional%20IP%20address%20field%20to%0A%09invoice%20format&In-Reply-To=%3C7c86de62-bb03-830a-51ef-f834d9a41a38%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000957.html">
   <LINK REL="Next"  HREF="000962.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Suggestion: Add optional IP address field to	invoice format</H1>
    <B>Ignatius Rivaldi</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Suggestion%3A%20Add%20optional%20IP%20address%20field%20to%0A%09invoice%20format&In-Reply-To=%3C7c86de62-bb03-830a-51ef-f834d9a41a38%40gmail.com%3E"
       TITLE="[Lightning-dev] Suggestion: Add optional IP address field to	invoice format">minecraft2048 at gmail.com
       </A><BR>
    <I>Fri Jan 26 11:35:13 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="000957.html">[Lightning-dev] [1.1] Proposed `funding_cancelled` message
</A></li>
        <LI>Next message: <A HREF="000962.html">[Lightning-dev] lightning operation during / following a chain fork	(e.g. BIP 50)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#961">[ date ]</a>
              <a href="thread.html#961">[ thread ]</a>
              <a href="subject.html#961">[ subject ]</a>
              <a href="author.html#961">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I think that there is a potential problem for sellers to accept 
lightning network. They need someone to open a channel with them that is 
filled with bitcoins so that they can start receiving bitcoins from 
other LN users. But what if a buyer can simultaneously open a channel 
and pay the seller? In order to do that they need to know the IP address 
of the seller and how much bitcoins they need to pay, so that they can 
push the appropriate amount of bitcoins to the seller side, satisfying 
the seller's transaction. But currently we opened a channel using the 
<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">pubkey at ip</A> format, which doesn't have amount information, and then we pay 
them using lntb... format, which doesn't have IP address information.

So my suggestion is to add optional IP address field to the lntb... 
invoice format. This will be optional because someone probably wants 
some privacy using LN. But with this combined lntb... + IP address 
invoice format, the LN wallet can be smarter in routing. Here are some 
scenarios:

1. A seller gives this combined invoice to a buyer, and then the buyer's 
LN wallet finds a route, which it finds. Then there will be LN 
transaction as usual.

2. A buyer regularly buy something from this seller, and then the wallet 
notices this, and then on the next transaction, the buyer's wallet will 
give suggestion to the user such as a checkbox that say &quot;Open a xxx mBTC 
channel for faster checkout next time&quot;. If the user checks that 
checkbox, the buyer's wallet will then do a LN transaction to the 
seller, while opening up a new channel toward the seller through another 
on-chain transaction.

3. A seller gives this combined invoice to a buyer, and then the buyer's 
LN wallet finds a route, which it fails to find. Then the buyer's wallet 
will open a channel toward the seller, and then push the requested 
amount of mBTC to the seller. Then the buyer's wallet will tell to the 
seller's wallet that we are essentially paying on-chain, and then the 
seller can react to it, for example if this is an online shop, they can 
ask the buyer to wait for confirmations, or if this a coffee shop, the 
seller could just ignore it and go zero-confirmation.

This new invoice format, combined with channel autopilot, will make 
better user experience as they can be sure that they can always pay an 
LN capable seller, without any route not found error. This will also 
makes the seller's lives easier, as they will have their channels opened 
and funded automatically by the buyers.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000957.html">[Lightning-dev] [1.1] Proposed `funding_cancelled` message
</A></li>
	<LI>Next message: <A HREF="000962.html">[Lightning-dev] lightning operation during / following a chain fork	(e.g. BIP 50)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#961">[ date ]</a>
              <a href="thread.html#961">[ thread ]</a>
              <a href="subject.html#961">[ subject ]</a>
              <a href="author.html#961">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
