<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] Unjamming lightning (new research paper)
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2022-November/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Unjamming%20lightning%20%28new%20research%20paper%29&In-Reply-To=%3CCACtNmG6Zr%3D_v1hTAgn2mDWLvnec6fX9Jbnuj6_DPU71FPzfY0w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003752.html">
   <LINK REL="Next"  HREF="003743.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] Unjamming lightning (new research paper)</H1>
    <B>Clara Shikhelman</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20Unjamming%20lightning%20%28new%20research%20paper%29&In-Reply-To=%3CCACtNmG6Zr%3D_v1hTAgn2mDWLvnec6fX9Jbnuj6_DPU71FPzfY0w%40mail.gmail.com%3E"
       TITLE="[Lightning-dev] Unjamming lightning (new research paper)">clara.shikhelman at gmail.com
       </A><BR>
    <I>Tue Nov 15 20:09:15 UTC 2022</I>
    <P><UL>
        <LI>Previous message: <A HREF="003752.html">[Lightning-dev] Unjamming lightning (new research paper)
</A></li>
        <LI>Next message: <A HREF="003743.html">[Lightning-dev] A pragmatic, unsatisfying work-around for anchor outputs fee-bumping reserve requirements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3753">[ date ]</a>
              <a href="thread.html#3753">[ thread ]</a>
              <a href="subject.html#3753">[ subject ]</a>
              <a href="author.html#3753">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks to everyone that came to the meeting, it was a great conversation
and gave us a lot to think about!

Matt &#8211; I don't know that I agree with &quot;... upfront payments kinda kill the
lightning UX ...&quot;. I think that upfront fees are almost essential, even
outside the context of jamming. This also helps with probing, general spam,
and other aspects. Furthermore, I think that the UX is very explainable,
and in general nodes shouldn't be motivated to send a lot of failed
payments, and should adopt better routing strategies.

About Rusty's suggestions, I plan to look at it again, but if I
remember correctly, there are privacy issues there.

I agree that we should tread carefully and not rush into things, let's keep
discussing this. I'll try to set up another meeting sometime soon.

On Mon, Nov 14, 2022 at 4:39 PM Matt Corallo &lt;<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">lf-lists at mattcorallo.com</A>&gt;
wrote:

&gt;<i> Thanks for committing all the time today. I&#8217;m much happier with (binary,
</I>&gt;<i> not-so-)local reputation than I was in the past, at least as better than
</I>&gt;<i> other reputation systems.
</I>&gt;<i>
</I>&gt;<i> I believe you&#8217;ve stated a few times that local reputation by itself is far
</I>&gt;<i> from sufficient and that&#8217;s why we need upfront payments. Intuitively this
</I>&gt;<i> makes sense to me but I&#8217;m sure you have more data to back that up. It&#8217;s
</I>&gt;<i> come up a few times that upfront payments kinda kill the lightning UX if
</I>&gt;<i> they&#8217;re at all nontrivial. Just restating here to make sure we&#8217;re on the
</I>&gt;<i> same page.
</I>&gt;<i>
</I>&gt;<i> One thing I think we need to research more is how this compares to Rusty&#8217;s
</I>&gt;<i> old proof-of-channel-closure idea. Philosophically it&#8217;s quite nice to
</I>&gt;<i> punish the one holding an HTLC over punishing the sender, especially in a
</I>&gt;<i> world where people are getting options in USD&lt;-&gt;BTC through HTLCs or
</I>&gt;<i> sending to mobile nodes that sit on payments. Practically I&#8217;m not sure if
</I>&gt;<i> there&#8217;s a strong need to worry about a large hub sitting on HTLCs to jam
</I>&gt;<i> instead of a sender  being involved, but having zero mitigation against it
</I>&gt;<i> also seems wrong.
</I>&gt;<i>
</I>&gt;<i> As always I&#8217;m a bit dubious of doing something, especially that required
</I>&gt;<i> network-wide upgrade, until we&#8217;re confident it&#8217;s the right direction. Even
</I>&gt;<i> binary HTLC reputation flags, I think, carry a very large privacy cost so
</I>&gt;<i> it&#8217;s strongly worth exploring every alternative before we commit.
</I>&gt;<i>
</I>&gt;<i> Matt
</I>&gt;<i>
</I>&gt;<i> On Nov 10, 2022, at 10:35, Clara Shikhelman &lt;<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">clara.shikhelman at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> &#65279;
</I>&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> We are planning a call to discuss this proposal further. It will be on
</I>&gt;<i> Monday the 14th, at 7 pm UTC here:
</I>&gt;<i> <A HREF="https://meet.jit.si/UnjammingLN">https://meet.jit.si/UnjammingLN</A>
</I>&gt;<i>
</I>&gt;<i> Please let me know if this conflicts with any other Bitcoin event.
</I>&gt;<i>
</I>&gt;<i> Hope to see you all there!
</I>&gt;<i>
</I>&gt;<i> On Thu, Nov 3, 2022 at 1:25 PM Clara Shikhelman &lt;
</I>&gt;<i> <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">clara.shikhelman at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi list,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We would like to share with you our recent research on jamming in
</I>&gt;&gt;<i> Lightning. We propose a combination of unconditional (~ upfront) fees and
</I>&gt;&gt;<i> local reputation to fight jamming. We believe this can be a basis for an
</I>&gt;&gt;<i> efficient and practical solution that can be implemented in the foreseeable
</I>&gt;&gt;<i> future.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The full paper is available [1].
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We classify jams into quick (resolve in seconds, mimicking honest
</I>&gt;&gt;<i> payments) and slow (remain in-flight for hours or days). Fees
</I>&gt;&gt;<i> disincentivize an attack where quick jams are constantly resolved and sent
</I>&gt;&gt;<i> again. Reputation, in turn, allows nodes to deprioritize peers who
</I>&gt;&gt;<i> consistently forward slow jams.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We believe that our proposal is practical and efficient. In particular,
</I>&gt;&gt;<i> we have shown that the additional (unconditional) fees can be relatively
</I>&gt;&gt;<i> low (as low as 2% of the total fee) to fully compensate jamming victims for
</I>&gt;&gt;<i> the lost routing revenue. Moreover, the total unconditional fee paid for
</I>&gt;&gt;<i> all failed attempts stays low even if the failure rate is reasonably high.
</I>&gt;&gt;<i> This means that the UX burden of paying for failed attempts is also low. A
</I>&gt;&gt;<i> straightforward PoC implementation [2] demonstrates one approach to
</I>&gt;&gt;<i> implementing the fee-related aspect of our proposal.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Further sections provide more details on our approach and results.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # Jamming
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As a reminder, jamming is a DoS attack where a malicious sender initiates
</I>&gt;&gt;<i> payments (jams) but delays finalizing them, blocking channels along the
</I>&gt;&gt;<i> route until the jams are resolved. Jamming may target liquidity or payment
</I>&gt;&gt;<i> slots.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We distinguish between quick and slow jamming. Quick jamming implies that
</I>&gt;&gt;<i> jams are failed and re-sent every few seconds, making them hardly
</I>&gt;&gt;<i> distinguishable from honest failing payments. In slow jamming, jams remain
</I>&gt;&gt;<i> in-flight for hours.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # Unconditional fees
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We propose unconditional fees to discourage quick jamming. Currently,
</I>&gt;&gt;<i> jams are free because routing nodes don&#8217;t charge for failed payment
</I>&gt;&gt;<i> attempts. With unconditional fees, however, jamming is no longer free.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Our simulations indicate that unconditional fees don&#8217;t have to be too
</I>&gt;&gt;<i> high. Under certain assumptions about the honest payment flow, a fee
</I>&gt;&gt;<i> increase by just 2% (paid upfront) fully compensates a routing node under
</I>&gt;&gt;<i> attack. Our simulator is open-source [3]. A PoC implementation demonstrates
</I>&gt;&gt;<i> one approach to implementing unconditional fees and only requires minor
</I>&gt;&gt;<i> changes [2].
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We have also considered the UX implications of paying for failed
</I>&gt;&gt;<i> attempts. We have concluded that this should not be a deal-breaker, as the
</I>&gt;&gt;<i> total unconditional fee paid stays low even if the failure rate is
</I>&gt;&gt;<i> reasonably high (even as high as 50%). Privacy and incentives are also
</I>&gt;&gt;<i> discussed in the paper.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # Reputation
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Fees are not very effective in preventing slow jamming: this type of
</I>&gt;&gt;<i> attack requires only a few jams, therefore, fees would have to be too high
</I>&gt;&gt;<i> to be effective. Instead, we address slow jamming using local reputation.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As per our proposal, nodes keep track of their peers&#8217; past behavior. A
</I>&gt;&gt;<i> routing node considers its peer &#8220;good&#8221; if it only forwards honest payments
</I>&gt;&gt;<i> that resolve quickly and bring sufficient fee revenue. A peer that forwards
</I>&gt;&gt;<i> jams, in contrast, loses reputation. Payments endorsed by a high-reputation
</I>&gt;&gt;<i> peer are forwarded on the best efforts basis, while other (&#8220;high-risk&#8221;)
</I>&gt;&gt;<i> payments can only use a predefined quota of liquidity and slots. Unless the
</I>&gt;&gt;<i> attacker has built up a reputation in advance, it cannot fully jam a
</I>&gt;&gt;<i> channel with at least some liquidity allocated exclusively to low-risk
</I>&gt;&gt;<i> payments. Nodes parameterize their channels according to their risk
</I>&gt;&gt;<i> tolerance.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> # Alternatives and Future Work
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In this work, we strive for a systematic approach. First, we list five
</I>&gt;&gt;<i> properties a potential mitigation strategy should have: effectiveness,
</I>&gt;&gt;<i> incentive compatibility, user experience, privacy and security, and ease of
</I>&gt;&gt;<i> implementation. Then, we go over the design decisions to be made when
</I>&gt;&gt;<i> constructing a countermeasure against jamming. Based on the desired
</I>&gt;&gt;<i> criteria and the available options, we converge on a solution.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Multiple approaches to jamming mitigation have been discussed on this
</I>&gt;&gt;<i> list and elsewhere. Many of them may well be worth exploring, such as
</I>&gt;&gt;<i> resolution-time-dependent fee amounts or stake certificates for reputation
</I>&gt;&gt;<i> building. However, we believe that our solution strikes a good balance: it
</I>&gt;&gt;<i> addresses the problem in question and is relatively straightforward to
</I>&gt;&gt;<i> implement.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> We would love to bring this idea closer to implementation, and we plan to
</I>&gt;&gt;<i> discuss it over the next spec meeting [4] (Monday, 2022-11-07). We&#8217;d
</I>&gt;&gt;<i> greatly appreciate your feedback!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Kind regards,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sergei and Clara
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [1] -
</I>&gt;&gt;<i> <A HREF="https://github.com/s-tikhomirov/ln-jamming-simulator/blob/master/unjamming-lightning.pdf">https://github.com/s-tikhomirov/ln-jamming-simulator/blob/master/unjamming-lightning.pdf</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [2] - <A HREF="https://github.com/sr-gi/rust-lightning/commit/ce606">https://github.com/sr-gi/rust-lightning/commit/ce606</A>)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [3] - <A HREF="https://github.com/s-tikhomirov/ln-jamming-simulator">https://github.com/s-tikhomirov/ln-jamming-simulator</A>
</I>&gt;&gt;<i> [4] - <A HREF="https://github.com/lightning/bolts/issues/1038">https://github.com/lightning/bolts/issues/1038</A>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Lightning-dev mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">Lightning-dev at lists.linuxfoundation.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev</A>
</I>&gt;&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Lightning-dev mailing list
</I>&gt;<i> <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">Lightning-dev at lists.linuxfoundation.org</A>
</I>&gt;<i> <A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20221115/e71ebd57/attachment-0001.html">http://lists.linuxfoundation.org/pipermail/lightning-dev/attachments/20221115/e71ebd57/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003752.html">[Lightning-dev] Unjamming lightning (new research paper)
</A></li>
	<LI>Next message: <A HREF="003743.html">[Lightning-dev] A pragmatic, unsatisfying work-around for anchor outputs fee-bumping reserve requirements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3753">[ date ]</a>
              <a href="thread.html#3753">[ thread ]</a>
              <a href="subject.html#3753">[ subject ]</a>
              <a href="author.html#3753">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
