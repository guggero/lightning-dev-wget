<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Lightning-dev] eltoo towers and implications for settlement	key derivation
   </TITLE>
   <LINK REL="Index" HREF="https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-December/index.html" >
   <LINK REL="made" HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20eltoo%20towers%20and%20implications%20for%20settlement%0A%09key%20derivation&In-Reply-To=%3C87wobejbxx.fsf%40rustcorp.com.au%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002365.html">
   <LINK REL="Next"  HREF="002361.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Lightning-dev] eltoo towers and implications for settlement	key derivation</H1>
    <B>Rusty Russell</B> 
    <A HREF="mailto:lightning-dev%40lists.linuxfoundation.org?Subject=Re:%20Re%3A%20%5BLightning-dev%5D%20eltoo%20towers%20and%20implications%20for%20settlement%0A%09key%20derivation&In-Reply-To=%3C87wobejbxx.fsf%40rustcorp.com.au%3E"
       TITLE="[Lightning-dev] eltoo towers and implications for settlement	key derivation">rusty at rustcorp.com.au
       </A><BR>
    <I>Tue Dec  3 04:00:10 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="002365.html">[Lightning-dev] eltoo towers and implications for settlement	key derivation
</A></li>
        <LI>Next message: <A HREF="002361.html">[Lightning-dev] eltoo towers and implications for settlement	key derivation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2360">[ date ]</a>
              <a href="thread.html#2360">[ thread ]</a>
              <a href="subject.html#2360">[ subject ]</a>
              <a href="author.html#2360">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>ZmnSCPxj &lt;<A HREF="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">ZmnSCPxj at protonmail.com</A>&gt; writes:
&gt;<i> Good morning Rusty,
</I>&gt;<i>
</I>&gt;&gt;<i> &gt; Hi all,
</I>&gt;&gt;<i> &gt; I recently revisited the eltoo paper and noticed some things related
</I>&gt;&gt;<i> &gt; watchtowers that might affect channel construction.
</I>&gt;&gt;<i> &gt; Due to NOINPUT, any update transaction can spend from any other, so
</I>&gt;&gt;<i> &gt; in theory the tower only needs the most recent update txn to resolve
</I>&gt;&gt;<i> &gt; any dispute.
</I>&gt;&gt;<i> &gt; In order to spend, however, the tower must also produce a witness
</I>&gt;&gt;<i> &gt; script which when hashed matches the witness program of the input. To
</I>&gt;&gt;<i> &gt; ensure settlement txns can only spend from exactly one update txn,
</I>&gt;&gt;<i> &gt; each update txn uses unique keys for the settlement clause, meaning
</I>&gt;&gt;<i> &gt; that each state has a unique witness program.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I didn't think this was the design. The update transaction can spend
</I>&gt;&gt;<i> any prior, with a fixed script, due to NOINPUT.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The settlement transaction does not use NOINPUT, and thus can only
</I>&gt;&gt;<i> spend the matching update.
</I>&gt;<i>
</I>&gt;<i> My understanding is that this is not logically possible?
</I>
You're right, no wonder I missed this problem :(

OK, so we need to change the key(s) every time.  Can we tweak it based
on something the watchtower will know, i.e. something in the update tx
itself?  Obviously not the output, as that would create a circular
dependency.  Is there some taproot thing we can use to insert some
noise in the input?

Cheers,
Rusty.
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002365.html">[Lightning-dev] eltoo towers and implications for settlement	key derivation
</A></li>
	<LI>Next message: <A HREF="002361.html">[Lightning-dev] eltoo towers and implications for settlement	key derivation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2360">[ date ]</a>
              <a href="thread.html#2360">[ thread ]</a>
              <a href="subject.html#2360">[ subject ]</a>
              <a href="author.html#2360">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.linuxfoundation.org/mailman/listinfo/lightning-dev">More information about the Lightning-dev
mailing list</a><br>
</body></html>
